<!DOCTYPE html>
<html lang="en-US">

<head> 
<style>
	<style>
  /* Hide the existing "Recent Songs / history" area so script can still target it safely */
  #historicSong,
  h3, h4 {
    /* If your old headings/containers have specific IDs/classes, hide those instead */
  }
  /* A safer, targeted rule (adjust selectors to your actual markup) */
  #historicSong { display: none !important; }

  /* New panel styling */
  .panel-dual { margin: 1.25rem 0; }
  .panel-dual details {
    border: 1px solid #d7d7d7; border-radius: 8px; background: #fff;
    box-shadow: 0 4px 14px rgba(0,0,0,.06); overflow: hidden;
  }
  .panel-dual summary {
    cursor: pointer; padding: .9rem 1.1rem; font-weight: 600; list-style: none;
    background: linear-gradient(180deg,#fafafa,#f3f3f3);
  }
  .panel-dual summary::-webkit-details-marker { display: none; }

  .dual-grid { display: grid; gap: 1rem; padding: 1rem; }
  @media (min-width: 700px) { .dual-grid { grid-template-columns: 1fr 1fr; } }

  .panel { background: #fff; border: 1px solid #eee; border-radius: 8px; padding: .75rem; }
  .panel h3 { margin: .25rem 0 .75rem; font-size: 1.05rem; }
  .list { list-style: none; margin: 0; padding: 0; }
  .list li { padding: .45rem .5rem; border-bottom: 1px dashed #e8e8e8; display: flex; gap: .5rem; align-items: center; }
  .list li:last-child { border-bottom: 0; }
  .list .text { flex: 1 1 auto; min-width: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

  .btn-icon {
    border: none; background: transparent; cursor: pointer; color: #888; font-size: .95rem;
  }
  .btn-icon:hover { color: #444; }
  .btn-add-fav {
    display: inline-flex; gap: .5rem; align-items: center;
    border: 1px solid #d0d0d0; border-radius: 20px;
    padding: .4rem .8rem; background: #fff; cursor: pointer; font-weight: 600;
    box-shadow: 0 2px 8px rgba(0,0,0,.05);
  }
  .btn-add-fav[disabled] { opacity: .5; cursor: not-allowed; }
  .empty { color: #888; font-style: italic; padding: .25rem .5rem; }
#customNowPlaying, #customRecentTracks {
    background-color: rgba(0, 0, 0, 0.5);
    color: white;
    padding: 10px 15px;
    border-radius: 8px;
    max-width: 400px;
    margin: 10px auto;
    font-family: sans-serif;
}
</style>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>RadioPlayer</title>

    <link rel="icon" type="image/png" href="img/cover.png" />
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/animate.css">
    <link rel="stylesheet" href="css/style.css?v2322">
</head>

<body>

    <div class="cover-site">
        <div id="bgCover"></div>
        <div class="bg-mask"></div>
    </div>
    <main>
        <section id="player">
            <div class="container">
                <div class="row web-player">
                    <div class="col-12 col-lg-10">
                        <div class="row">
                            <div class="col-12 col-md-5">
                                <div class="cover-album">
                                    <div id="currentCoverArt"></div>
                                    <div class="watermark"></div>
                                </div>
                            </div>
                            <div class="col-12 ml-md-auto col-md-6">
                                <div class="row">
                                    <div class="col-12">
                                        <div class="info-current-song"> </div>
<!-- Add-to-Favorites button -->
<button id="addToFavoritesBtn" class="btn-add-fav" type="button" aria-label="Add current track to Favorites">★ Add to Favorites</button>
                                        <div id="customNowPlaying" style="font-size: 1.2em; font-weight: bold; margin-top: 20px;">
                                        Loading current track...
                                        </div>
                                        
                                        <!-- Classical Music Information Box -->
                                        <div id="classicalInfo" style="background-color: rgba(0, 0, 0, 0.6); color: white; padding: 15px; border-radius: 10px; margin-top: 15px; display: none;">
                                            <h4 style="margin: 0 0 10px 0; color: #ffd700;">Classical Details</h4>
                                            <div id="composerEra" style="margin-bottom: 8px;">
                                                <strong>Composer:</strong> <span id="composer">--</span><br>
                                                <strong>Era:</strong> <span id="era">--</span><br>
                                                <strong>Year:</strong> <span id="compositionYear">--</span>
                                            </div>
                                            <div id="programNotes" style="font-size: 0.9em; line-height: 1.4; color: #e0e0e0;">
                                                <strong>About this piece:</strong><br>
                                                <span id="description">Loading classical information...</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="row">
                                            <div class="play-pause col-12 col-md-6 text-center">
                                                <button class="btn-play" onclick="togglePlay()"><i id="playerButton" class="fa fa-play"></i> <span id="buttonPlay">PLAY</span></button>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-12 col-md-6 text-center">
                                                <div class="row volume-control">
                                                    <div class="volume-icon col-1"><i class="fa fa-volume-up"></i></div>
                                                    <div class="volume-slide col-10 text-center"><input type="range" id="volume"
                                                            step="1" min="0" max="100" value="80"></div>
                                                    <div class="percentual-volume col-12">Volume <span id="volIndicator">...</span>%</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-12 col-md-6 text-center call-tracklist">
                                                <a href="https://example.com" target="_blank" class="tracklist">WRCJ TRACKLIST</a>
                                            </div>
                                        </div>
                </div>
             <section class="panel-dual" id="favRecentSection">
  <details open>
    <summary><strong>Favorites / Recently Played</strong></summary>
    <div class="dual-grid">
      <div class="panel">
        <h3>Favorites</h3>
        <ul id="favoritesList" class="list"></ul>
        <p class="empty" id="favoritesEmpty">No favorites yet — click “Add to Favorites”.</p>
      </div>
      <div class="panel">
        <h3>Recently Played</h3>
        <!-- Reuse the same UL ID your script already populates -->        
<ul id="recentTracksMount" class="list"></ul>
  <p class="empty" id="recentEmpty" style="display:none;">No recent tracks yet.</p>
</div>
      </div>
    </div>
  </details>
</section>

    <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/script.js"></script>
<script>
(() => {
  // Move the original #recentTracksList into our new panel placeholder.
  const mount = document.getElementById('recentTracksMount');
  const existing = document.getElementById('recentTracksList'); // created/used by your current code
  if (mount && existing && mount !== existing) {
    // Replace the mount placeholder with the real list element so your script keeps filling it
    mount.replaceWith(existing);
    // Make sure it's visible even if inherited hidden styles exist
    existing.style.display = '';
  }

  // Optional: show/hide the "No recent tracks" hint automatically
  const recentEmpty = document.getElementById('recentEmpty');
  if (existing && recentEmpty) {
    const toggleHint = () => {
      recentEmpty.style.display = existing.children.length > 0 ? 'none' : '';
    };
    new MutationObserver(toggleHint).observe(existing, { childList: true });
    toggleHint();
  }
})();
</script>

	<script>
(() => {
  const STORAGE_KEY = 'favoriteTracks';
  const btn = document.getElementById('addToFavoritesBtn');
  const nowEl = document.getElementById('customNowPlaying');
  const favList = document.getElementById('favoritesList');
  const favEmpty = document.getElementById('favoritesEmpty');
  const recentList = document.getElementById('recentTracksList');
  const recentEmpty = document.getElementById('recentEmpty');

  let favorites = [];

  function loadFavorites() {
    try {
      favorites = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    } catch { favorites = []; }
    renderFavorites();
    syncAddButton();
  }

  function saveFavorites() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(favorites));
  }

  function addFavorite(track) {
    if (!track || track.trim() === '') return;
    if (favorites.some(f => f.track === track)) return; // dedupe
    favorites.unshift({ track, addedAt: Date.now() });
    saveFavorites();
    renderFavorites();
    syncAddButton();
  }

  function removeFavorite(index) {
    favorites.splice(index, 1);
    saveFavorites();
    renderFavorites();
    syncAddButton();
  }

  function renderFavorites() {
    favList.innerHTML = '';
    if (favorites.length === 0) {
      favEmpty.style.display = '';
      return;
    }
    favEmpty.style.display = 'none';
    favorites.forEach((item, idx) => {
      const li = document.createElement('li');
      const text = document.createElement('span');
      text.className = 'text';
      text.textContent = item.track;

      const del = document.createElement('button');
      del.className = 'btn-icon';
      del.title = 'Remove from favorites';
      del.setAttribute('aria-label', `Remove ${item.track} from favorites`);
      del.textContent = '✕';
      del.addEventListener('click', () => removeFavorite(idx));

      li.appendChild(text);
      li.appendChild(del);
      favList.appendChild(li);
    });
  }

  function currentTrack() {
    return (nowEl?.innerText || '').trim();
  }

  function syncAddButton() {
    const track = currentTrack();
    const exists = favorites.some(f => f.track === track);
    btn.disabled = !track || exists;
    btn.title = exists ? 'Already in favorites' : 'Add current track to Favorites';
  }

  // When user clicks the star button
  btn?.addEventListener('click', () => {
    const track = currentTrack();
    addFavorite(track);
  });

  // Watch for changes in the now playing text to update button state
  if (nowEl) {
    const obs = new MutationObserver(syncAddButton);
    obs.observe(nowEl, { childList: true, characterData: true, subtree: true });
  }

  // Watch for changes to the recent list that your existing script fills,
  // so we can show/hide "empty" hint accordingly (without overriding your function).
  if (recentList && recentEmpty) {
    const recentObs = new MutationObserver(() => {
      const hasItems = recentList.children.length > 0;
      recentEmpty.style.display = hasItems ? 'none' : '';
    });
    recentObs.observe(recentList, { childList: true });
  }

  // Init
  loadFavorites();
})();
</script>
	</body>
</html>
